<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Ä¢ CTF Tournament</title>
  <link rel="stylesheet" href="/static/assets/styles.css">
</head>

<body class="auth landing">
<div class="landing-shell landing-header-inner">
  <div class="landing-shell">
    <div class="brand">
      <div class="brand-mark">CTF</div>
      <div class="brand-text">
        <div class="brand-title">CTF Tournament</div>
        <div class="brand-sub">–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞</div>
      </div>
    </div>

    <nav class="landing-nav">
      <a class="nav-link" href="/">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
      <a class="nav-link" href="/login">–í—Ö–æ–¥</a>
    </nav>

    <div class="landing-actions">
      <a class="btn secondary" href="/">–ì–ª–∞–≤–Ω–∞—è</a>
      <a class="btn" href="/login">–í—Ö–æ–¥</a>
    </div>
  </div>
</header>

<main class="landing-main">
  <section class="auth-wrap">
    <div class="landing-shell auth-grid">

      <!-- LEFT -->
      <div class="auth-left glass">
        <div class="chip"><span class="dot"></span> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
        <h1 class="auth-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h1>
        <p class="muted auth-desc">
          –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ CTF-–º–∞—Ç—á–∞—Ö, –≤—Å—Ç—É–ø–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥—ã –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—á–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞.
        </p>

        <div class="auth-bullets">
          <div class="bullet"><span>üßæ</span> –ü–æ–¥–∞—á–∞ –∑–∞—è–≤–æ–∫ –Ω–∞ –º–∞—Ç—á–∏</div>
          <div class="bullet"><span>üë•</span> Team-–º–∞—Ç—á–∏ –∏ –≥—Ä—É–ø–ø—ã</div>
          <div class="bullet"><span>üèÜ</span> –û—á–∫–∏ –∏ —Ä–µ–π—Ç–∏–Ω–≥</div>
        </div>

        <div class="small muted" style="margin-top:14px;">
          –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?
          <a class="link" href="/login">–í–æ–π—Ç–∏</a>
        </div>
      </div>

      <!-- RIGHT -->
      <div class="auth-right glass">
        <div class="auth-card-head">
          <div>
            <div class="auth-card-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            <div class="small muted">–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å</div>
          </div>
          <a class="btn secondary" href="/">‚Üê –ù–∞–∑–∞–¥</a>
        </div>

        <form id="regForm" class="auth-form">
          <label class="field">
            <span class="field-label">–õ–æ–≥–∏–Ω</span>
            <input id="username" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: test@test.com" required />
          </label>

          <label class="field">
            <span class="field-label">–ü–∞—Ä–æ–ª—å</span>
            <div class="field-pass">
              <input id="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
              <button type="button" class="icon-btn" id="togglePass1">üëÅ</button>
            </div>
          </label>

          <label class="field">
            <span class="field-label">–ü–æ–≤—Ç–æ—Ä –ø–∞—Ä–æ–ª—è</span>
            <div class="field-pass">
              <input id="password2" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
              <button type="button" class="icon-btn" id="togglePass2">üëÅ</button>
            </div>
          </label>

          <button class="btn auth-submit" type="submit">
            –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
          </button>

          <div id="msg" class="small" style="margin-top:10px;"></div>

          <div class="auth-divider"><span>–∏–ª–∏</span></div>

          <a class="btn secondary auth-alt" href="/login">
            –£ –º–µ–Ω—è —É–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç
          </a>
        </form>
      </div>

    </div>
  </section>
</main>

<div class="noise"></div>

<script type="module">
import { api } from "/static/assets/api.js";

const form = document.getElementById("regForm");
const msg = document.getElementById("msg");

document.getElementById("togglePass1").onclick = () => {
  const p = document.getElementById("password");
  p.type = p.type === "password" ? "text" : "password";
};
document.getElementById("togglePass2").onclick = () => {
  const p = document.getElementById("password2");
  p.type = p.type === "password" ? "text" : "password";
};

form.onsubmit = async (e) => {
  e.preventDefault();
  msg.textContent = "";
  msg.style.color = "rgba(255,255,255,.85)";

  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value;
  const password2 = document.getElementById("password2").value;

  if (!username || !password || !password2) {
    msg.textContent = "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.";
    msg.style.color = "#ff9a9a";
    return;
  }
  if (password !== password2) {
    msg.textContent = "–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç.";
    msg.style.color = "#ff9a9a";
    return;
  }
  if (password.length < 6) {
    msg.textContent = "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤.";
    msg.style.color = "#ff9a9a";
    return;
  }

  msg.textContent = "–°–æ–∑–¥–∞—é –∞–∫–∫–∞—É–Ω—Ç...";

  try {
    await api("/auth/register", "POST", {
      username,
      password,
      password2
    });

    msg.textContent = "–ì–æ—Ç–æ–≤–æ! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é –Ω–∞ –≤—Ö–æ–¥...";
    msg.style.color = "rgba(110,240,210,.95)";
    setTimeout(() => location.href = "/login", 800);

  } catch (err) {
    msg.textContent = "–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: " + err.message;
    msg.style.color = "#ff9a9a";
  }
};
</script>
</body>
</html>
